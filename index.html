<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ø®ØªØ¨Ø§Ø± ØªÙØ§Ø¹Ù„ÙŠ | Ø£. Ø¥ÙŠÙ‡Ø§Ø¨ Ø£Ø´Ø±Ù</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');

body{
  margin:0;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  font-family:'Cairo',sans-serif;
  color:#fff;
  min-height: 100vh;
}

.container{
  max-width:900px;
  margin:auto;
  padding:20px;
}

h1{text-align:center;}

textarea{
  width:100%;
  height:200px;
  border-radius:16px;
  border:none;
  padding:15px;
  font-size:16px;
  margin-bottom:15px;
  box-sizing: border-box;
}

button{
  padding:14px 20px;
  border:none;
  border-radius:16px;
  font-size:16px;
  background:#ffd369;
  cursor:pointer;
  transition:.3s;
  font-weight: bold;
}

button:hover{
  background:#ffbe33;
}

/* ØªØ¹Ø¯ÙŠÙ„ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØªØµÙˆÙŠØ± Ù„ØªØ´Ù…Ù„ Ø§Ù„Ø®Ù„ÙÙŠØ© ÙˆØ§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø¨Ø´ÙƒÙ„ ÙƒØ§Ù…Ù„ */
#captureArea {
  background: linear-gradient(135deg,#1a2a6c,#0f2027);
  padding: 30px;
  border-radius: 30px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.4);
  margin-top: 25px;
  /* Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… Ø¸Ù‡ÙˆØ± Ø­ÙˆØ§Ù Ø¨ÙŠØ¶Ø§Ø¡ Ø¹Ù†Ø¯ Ø§Ù„ØªØµÙˆÙŠØ± */
  overflow: hidden; 
}

#question{
  font-size:22px;
  margin-bottom:25px;
  line-height: 1.6;
}

.option{
  background:rgba(255,255,255,0.15);
  padding:15px;
  border-radius:20px;
  margin:12px 0;
  cursor:pointer;
  transition:.3s;
  border: 1px solid rgba(255,255,255,0.1);
}

.option.selected{
  background:#ffd369;
  color:#000;
  font-weight: bold;
}

.controls{
  display:flex;
  justify-content:center;
  gap:15px;
  margin-top:20px;
  flex-wrap:wrap;
}

.hidden{display:none;}

/* Ø²Ø± Ø®Ø§Øµ Ù„Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± */
.download-btn {
    background-color: #4CAF50;
    color: white;
}
</style>
</head>

<body>

<div class="container">
    <h1>ğŸ§  Ø§Ø®ØªØ¨Ø§Ø± ØªÙØ§Ø¹Ù„ÙŠ</h1>

    <div id="setupSection">
        <textarea id="input" placeholder="Ù…Ø«Ø§Ù„ Ù„Ù„ØµÙŠØºØ©:
Ø³: Ù…Ø§ Ù‡ÙŠ Ø¹Ø§ØµÙ…Ø© Ù…ØµØ±ØŸ
Ø£: Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©
Ø¨: Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©
Ø¬: Ø£Ø³ÙˆØ§Ù†
Ø¯: Ø§Ù„Ø¬ÙŠØ²Ø©
Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©: Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©"></textarea>
        <button onclick="startQuiz()" style="width: 100%;">Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ğŸš€</button>
    </div>

    <div id="quiz" class="hidden">
        <div id="captureArea">
            <div id="question"></div>
            <div id="options"></div>
        </div>

        <div class="controls">
            <button onclick="screenshotQuestion()" class="download-btn">ğŸ“· ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø© Ø§Ù„Ø³Ø¤Ø§Ù„</button>
            <button onclick="nextQuestion()">Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ â­ï¸</button>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
let questions = [];
let current = 0;

function startQuiz(){
  const text = document.getElementById("input").value.trim();
  if(!text) { alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø£ÙˆÙ„Ø§Ù‹"); return; }
  
  const blocks = text.split("\n\n");
  questions = [];
  current = 0;

  blocks.forEach(block=>{
    const lines = block.split("\n").filter(l => l.trim() !== "");
    if(lines.length >= 6){
      questions.push({
        q: lines[0].replace("Ø³:","").trim(),
        options: lines.slice(1,5).map(l=>l.trim()),
        answer: lines[5].split(":")[1]?.trim() || ""
      });
    }
  });

  if(questions.length === 0){
    alert("ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØ¨Ø§Ø¹ ØµÙŠØºØ© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© (Ø³Ø¤Ø§Ù„ØŒ 4 Ø§Ø®ØªÙŠØ§Ø±Ø§ØªØŒ Ø«Ù… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©)");
    return;
  }

  document.getElementById("setupSection").classList.add("hidden");
  document.getElementById("quiz").classList.remove("hidden");
  showQuestion();
}

function showQuestion(){
  const q = questions[current];
  document.getElementById("question").innerText = `(${current+1}/${questions.length}) ${q.q}`;

  const optionsDiv = document.getElementById("options");
  optionsDiv.innerHTML = "";

  q.options.forEach((opt)=>{
    const div = document.createElement("div");
    div.className = "option";
    div.innerText = opt;
    div.onclick = ()=>{
      document.querySelectorAll('.option').forEach(o=>o.classList.remove('selected'));
      div.classList.add('selected');
    };
    optionsDiv.appendChild(div);
  });
}

function nextQuestion(){
  current++;
  if(current < questions.length){
    showQuestion();
  }else{
    alert("ğŸ‰ Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±!");
    location.reload(); // Ù„Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¨Ø¯Ø§ÙŠØ©
  }
}

function screenshotQuestion(){
  const element = document.getElementById("captureArea");
  
  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø­Ø³Ù†Ø© Ù„Ø¶Ù…Ø§Ù† Ø¬ÙˆØ¯Ø© Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ§Ù„Ø£Ø¨Ø¹Ø§Ø¯
  html2canvas(element, {
    backgroundColor: null, // ÙŠØ³Ù…Ø­ Ø¨Ø¸Ù‡ÙˆØ± Ø§Ù„ØªØ¯Ø±Ø¬ Ø§Ù„Ù„ÙˆÙ†ÙŠ
    scale: 3, // Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ© Ø¬Ø¯Ø§Ù‹ (Ø£ÙˆØ¶Ø­ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙƒØ©)
    useCORS: true,
    logging: false,
    letterRendering: true,
    allowTaint: false
  }).then(canvas => {
    // ÙƒÙˆØ¯ Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† ÙØªØ­Ù‡Ø§ ÙÙŠ Ù†Ø§ÙØ°Ø© Ù‚Ø¯ ÙŠØ­Ø¬Ø¨Ù‡Ø§ Ø§Ù„Ù…ØªØµÙØ­
    const link = document.createElement('a');
    link.download = `Ø³Ø¤Ø§Ù„-${current+1}.png`;
    link.href = canvas.toDataURL("image/png");
    link.click();
  });
}
</script>

</body>
</html>
